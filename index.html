<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Para Ale âœ¨</title>
  <style>
    :root{
      --bg0:#050511;
      --bg1:#090822;
      --bg2:#120b3b;
      --txt:#ffffff;
      --soft:#ffffffc7;
      --glass:#ffffff14;
      --glass2:#ffffff22;
      --stroke:#ffffff2a;
      --pink:#ff5fa2;
      --violet:#8b5cff;
      --cyan:#2fe7ff;
      --shadow: 0 30px 80px rgba(0,0,0,.55);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; }
    body{
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--txt);
      background: radial-gradient(1200px 900px at 20% 15%, rgba(255,95,162,.18), transparent 60%),
                  radial-gradient(1000px 800px at 80% 30%, rgba(139,92,255,.18), transparent 60%),
                  radial-gradient(900px 700px at 50% 80%, rgba(47,231,255,.10), transparent 60%),
                  linear-gradient(180deg, var(--bg0), var(--bg2));
      overflow:hidden;
      touch-action: pan-y;
    }

    /* === Escena 3D (parallax) === */
    .scene{
      position:fixed; inset:0;
      perspective: 900px;
      transform-style: preserve-3d;
    }
    .layer{
      position:absolute; inset:-10%;
      transform-style:preserve-3d;
      will-change: transform;
      pointer-events:none;
    }

    /* Nebulosas (manchas suaves) */
    .nebula{
      background:
        radial-gradient(closest-side at 20% 30%, rgba(255,95,162,.22), transparent 60%),
        radial-gradient(closest-side at 70% 35%, rgba(139,92,255,.20), transparent 60%),
        radial-gradient(closest-side at 55% 80%, rgba(47,231,255,.10), transparent 60%);
      filter: blur(18px);
      opacity:.9;
      mix-blend-mode: screen;
    }

    /* Brillo/ruido */
    .glow{
      background:
        radial-gradient(600px 400px at 50% 50%, rgba(255,255,255,.10), transparent 60%),
        radial-gradient(500px 300px at 30% 60%, rgba(255,255,255,.06), transparent 60%);
      filter: blur(10px);
      opacity:.7;
    }

    canvas#stars, canvas#dust{
      position:absolute; inset:0;
      width:100%; height:100%;
      display:block;
      pointer-events:none;
    }

    /* === UI === */
    .ui{
      position:relative;
      z-index:5;
      height:100%;
      display:grid;
      grid-template-rows: auto 1fr auto;
      padding: 18px 16px 22px;
      gap: 12px;
    }

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding: 12px 14px;
      border-radius: 18px;
      background: linear-gradient(135deg, var(--glass), var(--glass2));
      border:1px solid var(--stroke);
      backdrop-filter: blur(12px);
      box-shadow: 0 12px 30px rgba(0,0,0,.35);
    }
    .brand{
      display:flex; flex-direction:column;
      line-height:1.1;
    }
    .brand .t1{
      font-weight:750;
      letter-spacing:.2px;
      font-size: 15px;
    }
    .brand .t2{
      font-size: 12px;
      color: var(--soft);
      margin-top:3px;
    }
    .chip{
      padding: 8px 10px;
      border-radius: 999px;
      background: #00000022;
      border:1px solid #ffffff22;
      font-size:12px;
      color:#ffffffde;
      user-select:none;
      display:flex;
      align-items:center;
      gap:6px;
    }

    /* Ãrea de mensajes flotantes */
    .field{
      position:relative;
      border-radius: 22px;
      border:1px solid #ffffff1f;
      background: linear-gradient(135deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      overflow:hidden;
      min-height: 380px;
    }

    .hint{
      position:absolute;
      left:14px; right:14px; top:14px;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      pointer-events:none;
      z-index:2;
    }
    .hint .text{
      font-size:12px;
      color:#ffffffc8;
      background:#00000022;
      border:1px solid #ffffff1f;
      padding:9px 10px;
      border-radius: 14px;
      max-width: 75%;
      backdrop-filter: blur(8px);
    }
    .hint .mini{
      font-size:12px;
      padding:9px 10px;
      border-radius:14px;
      background:#00000022;
      border:1px solid #ffffff1f;
      color:#ffffffc8;
      backdrop-filter: blur(8px);
      white-space:nowrap;
    }

    .bubble{
      position:absolute;
      display:flex;
      align-items:center;
      gap:10px;
      padding: 10px 12px;
      border-radius: 999px;
      border:1px solid #ffffff2a;
      background: linear-gradient(135deg, rgba(255,255,255,.12), rgba(255,255,255,.06));
      box-shadow: 0 18px 40px rgba(0,0,0,.35);
      backdrop-filter: blur(10px);
      cursor:pointer;
      user-select:none;
      will-change: transform;
      transform: translate3d(0,0,0);
      transition: transform .12s ease;
    }
    .bubble:active{ transform: scale(.98); }

    .emoji{
      font-size: 18px;
      filter: drop-shadow(0 10px 16px rgba(0,0,0,.35));
    }
    .label{
      font-size: 13px;
      color:#ffffffef;
      letter-spacing:.15px;
    }

    /* Footer */
    .footer{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:center;
    }
    button{
      border:1px solid #ffffff26;
      background: #ffffff12;
      color:var(--txt);
      padding: 12px 14px;
      border-radius: 16px;
      font-size: 14px;
      cursor:pointer;
      user-select:none;
      backdrop-filter: blur(10px);
      box-shadow: 0 12px 24px rgba(0,0,0,.25);
      transition: transform .06s ease;
    }
    button:active{ transform: scale(.98); }
    button.primary{
      border-color:#ff5fa255;
      background: linear-gradient(135deg, rgba(255,95,162,.95), rgba(139,92,255,.92));
    }

    /* Modal carta */
    .modal{
      position:fixed; inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      padding: 18px;
      z-index: 50;
      background: rgba(0,0,0,.55);
      backdrop-filter: blur(8px);
    }
    .modal.show{ display:flex; }
    .card{
      width: min(520px, 100%);
      border-radius: 22px;
      border:1px solid #ffffff2a;
      background: linear-gradient(135deg, rgba(255,255,255,.14), rgba(255,255,255,.08));
      box-shadow: 0 30px 90px rgba(0,0,0,.6);
      padding: 18px 16px 14px;
      position:relative;
      overflow:hidden;
    }
    .card::before{
      content:"";
      position:absolute; inset:-40%;
      background: radial-gradient(circle at 30% 30%, rgba(255,95,162,.26), transparent 55%),
                  radial-gradient(circle at 70% 35%, rgba(139,92,255,.22), transparent 55%),
                  radial-gradient(circle at 45% 80%, rgba(47,231,255,.12), transparent 55%);
      filter: blur(18px);
      opacity:.8;
      transform: rotate(8deg);
      pointer-events:none;
    }
    .card > *{ position:relative; z-index:2; }

    .cardTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:10px;
    }
    .tag{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding: 8px 10px;
      border-radius: 999px;
      background:#00000022;
      border:1px solid #ffffff1f;
      font-size:12px;
      color:#ffffffde;
    }
    .close{
      border:none;
      background:#00000030;
      color:#fff;
      width: 40px;
      height: 40px;
      border-radius: 14px;
      cursor:pointer;
      border:1px solid #ffffff20;
    }
    .title{
      margin: 8px 0 6px;
      font-size: 18px;
      font-weight: 800;
      letter-spacing:.2px;
    }
    .text{
      margin: 0;
      font-size: 14px;
      line-height: 1.55;
      color:#ffffffeb;
      white-space: pre-wrap;
    }
    .sig{
      margin-top: 12px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      color:#ffffffb8;
      font-size:12px;
    }

    .toast{
      position:fixed;
      left:50%;
      bottom: 18px;
      transform: translateX(-50%);
      background: rgba(0,0,0,.55);
      border:1px solid #ffffff24;
      padding: 10px 12px;
      border-radius: 16px;
      color:#fff;
      font-size: 13px;
      backdrop-filter: blur(10px);
      z-index: 60;
      opacity:0;
      transition: opacity .2s ease;
      pointer-events:none;
    }
    .toast.show{ opacity:1; }

    /* Accesibilidad en pantallas pequeÃ±as */
    @media (max-height: 700px){
      .field{ min-height: 330px; }
    }
  </style>
</head>

<body>
  <div class="scene" id="scene">
    <div class="layer nebula" id="layer1"></div>
    <canvas id="stars"></canvas>
    <canvas id="dust"></canvas>
    <div class="layer glow" id="layer2"></div>
  </div>

  <div class="ui">
    <div class="topbar">
      <div class="brand">
        <div class="t1">Para Ale âœ¨</div>
        <div class="t2">Xmiau edition â€¢ toca los mensajes</div>
      </div>
      <div class="chip">ðŸŒŒ <span id="chipText">Galaxia</span></div>
    </div>

    <div class="field" id="field">
      <div class="hint">
        <div class="text">Toca cualquier burbuja ðŸ’¬ para abrir una cartita. (Se mueven como en el espacio ðŸŒ )</div>
        <div class="mini" id="counter">0/0</div>
      </div>
    </div>

    <div class="footer">
      <button class="primary" id="btnShuffle">âœ¨ Reordenar</button>
      <button id="btnMore">âž• MÃ¡s mensajes</button>
      <button id="btnCopy">ðŸ“‹ Copiar una carta</button>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal" id="modal" aria-hidden="true">
    <div class="card" role="dialog" aria-modal="true" aria-label="Carta">
      <div class="cardTop">
        <div class="tag" id="tag">ðŸ’Œ Carta</div>
        <button class="close" id="close" aria-label="Cerrar">âœ•</button>
      </div>
      <div class="title" id="mTitle">â€¦</div>
      <p class="text" id="mText"></p>
      <div class="sig">
        <span id="mFoot">Hecho con cariÃ±o ðŸ’–</span>
        <span id="mEmoji">ðŸŒ™</span>
      </div>
    </div>
  </div>

  <div class="toast" id="toast">Copiado âœ…</div>

<script>
  // ====== Personaliza ======
  const NAME_SHORT = "Ale";
  const ART_NAME  = "Xmiau";
  // =========================

  const field = document.getElementById("field");
  const counter = document.getElementById("counter");
  const chipText = document.getElementById("chipText");

  const modal = document.getElementById("modal");
  const closeBtn = document.getElementById("close");
  const tagEl = document.getElementById("tag");
  const mTitle = document.getElementById("mTitle");
  const mText  = document.getElementById("mText");
  const mFoot  = document.getElementById("mFoot");
  const mEmoji = document.getElementById("mEmoji");
  const toastEl = document.getElementById("toast");

  const btnShuffle = document.getElementById("btnShuffle");
  const btnMore = document.getElementById("btnMore");
  const btnCopy = document.getElementById("btnCopy");

  // Mensajes flotantes (cada uno abre una carta)
  const baseNotes = [
    { emoji:"ðŸ’–", label:"Para ti", title:`Hola, ${NAME_SHORT} âœ¨`, text:`Hoy solo vengo a decirte algo simple:\n\nTu energÃ­a se nota, tu presencia se siente.\nGracias por ser tÃº.\n\nFeliz 14, ${NAME_SHORT} ðŸ’–`, foot:`â€” ${ART_NAME} vibes`, tag:"ðŸ’Œ Carta 01" },
    { emoji:"ðŸŒ™", label:"Un secretito", title:`PequeÃ±o secreto`, text:`Cuando el mundo se pone pesado, pensar en ti lo vuelve mÃ¡s suave.\n\nNo sÃ© cÃ³mo lo haces, pero calmas.\nFeliz 14, ${NAME_SHORT} ðŸŒ™`, foot:`Con cariÃ±o`, tag:"ðŸ’Œ Carta 02" },
    { emoji:"ðŸ¾", label:"Modo Xmiau", title:`Modo ${ART_NAME} activado ðŸ¾`, text:`Si el 14 fuera un emoji, serÃ­a uno que te quede:\nâœ¨ + ðŸ˜Œ + ðŸ’˜\n\nEres magia tranquila, ${NAME_SHORT}.`, foot:`miau miau ðŸ¾`, tag:"ðŸ’Œ Carta 03" },
    { emoji:"ðŸŒŒ", label:"Galaxia", title:`En esta galaxiaâ€¦`, text:`Hay estrellas, hay planetasâ€¦\nY hay personas que brillan diferente.\n\nTÃº eres de esas, ${NAME_SHORT}.`, foot:`Te mando luz âœ¨`, tag:"ðŸ’Œ Carta 04" },
    { emoji:"ðŸ˜‚", label:"Coquetito", title:`Oferta limitada ðŸ˜`, text:`CupÃ³n del dÃ­a:\n\n1 abrazo + 1 sonrisa + 1 â€œme caes demasiado bienâ€\nVÃ¡lido solo para ${NAME_SHORT} ðŸ’˜`, foot:`No reembolsable`, tag:"ðŸ’Œ Carta 05" },
    { emoji:"ðŸ«¶", label:"Gracias", title:`Gracias, Ale`, text:`Gracias por existir como existes.\nPor tu forma.\nPor tu esencia.\n\nFeliz 14 ðŸ«¶`, foot:`Siempre bonito`, tag:"ðŸ’Œ Carta 06" },
  ];

  let notes = [...baseNotes];
  let openedCount = 0;

  function updateCounter(){
    counter.textContent = `${openedCount}/${notes.length}`;
  }

  // Crear burbujas con fÃ­sica simple (rebote + drift)
  const bubbles = [];
  const rand = (a,b)=> a + Math.random()*(b-a);

  function spawnBubbles(list){
    const rect = field.getBoundingClientRect();
    for(const n of list){
      const el = document.createElement("div");
      el.className = "bubble";
      el.innerHTML = `<span class="emoji">${n.emoji}</span><span class="label">${n.label}</span>`;
      field.appendChild(el);

      // PosiciÃ³n inicial
      const x = rand(30, rect.width - 160);
      const y = rand(70, rect.height - 80);

      // Velocidad
      const vx = rand(-0.35, 0.35);
      const vy = rand(-0.30, 0.30);

      const b = {
        note: n,
        el,
        x, y, vx, vy,
        // efecto "profundidad"
        z: rand(0.6, 1.2),
        wobble: rand(0, Math.PI*2)
      };

      el.style.transform = `translate3d(${b.x}px, ${b.y}px, 0) scale(${b.z})`;
      el.addEventListener("click", ()=> openLetter(b.note));
      bubbles.push(b);
    }
    updateCounter();
  }

  function clearBubbles(){
    for(const b of bubbles){ b.el.remove(); }
    bubbles.length = 0;
  }

  function layoutAll(){
    clearBubbles();
    spawnBubbles(notes);
    openedCount = 0;
    updateCounter();
  }

  // Modal carta
  function openLetter(note){
    openedCount = Math.min(openedCount + 1, notes.length);
    updateCounter();

    tagEl.textContent = note.tag || "ðŸ’Œ Carta";
    mTitle.textContent = note.title;
    mText.textContent  = note.text;
    mFoot.textContent  = note.foot || "Hecho con cariÃ±o ðŸ’–";
    mEmoji.textContent = note.emoji || "ðŸ’–";

    modal.classList.add("show");
    modal.setAttribute("aria-hidden","false");
    chipText.textContent = "Carta abierta";
  }

  function closeLetter(){
    modal.classList.remove("show");
    modal.setAttribute("aria-hidden","true");
    chipText.textContent = "Galaxia";
  }
  closeBtn.addEventListener("click", closeLetter);
  modal.addEventListener("click", (e)=>{ if(e.target === modal) closeLetter(); });
  addEventListener("keydown", (e)=>{ if(e.key === "Escape") closeLetter(); });

  // Toast
  let toastTimer;
  function toast(msg){
    toastEl.textContent = msg;
    toastEl.classList.add("show");
    clearTimeout(toastTimer);
    toastTimer = setTimeout(()=> toastEl.classList.remove("show"), 1500);
  }

  // Copiar una carta aleatoria
  btnCopy.addEventListener("click", async ()=>{
    const pick = notes[Math.floor(Math.random()*notes.length)];
    const text = `${pick.title}\n\n${pick.text}\n\n${pick.foot || ""}`;
    try{
      await navigator.clipboard.writeText(text);
      toast("Carta copiada âœ…");
    }catch{
      toast("No se pudo copiar ðŸ˜…");
    }
  });

  // Agregar mÃ¡s mensajes
  btnMore.addEventListener("click", ()=>{
    const extra = [
      { emoji:"ðŸ’«", label:"Brillas", title:`Brillas, ${NAME_SHORT}`, text:`No lo olvides:\n\nNo tienes que hacer ruido para brillar.\nTu forma de ser ya ilumina. ðŸ’«`, foot:`Con amor`, tag:"ðŸ’Œ Carta 07" },
      { emoji:"ðŸŒ·", label:"Dulce", title:`Un detalle`, text:`Esto es un mini detalle en formato galaxia.\n\nPorque tÃº mereces cosas bonitas, Ale ðŸŒ·`, foot:`Feliz 14`, tag:"ðŸ’Œ Carta 08" },
      { emoji:"ðŸª", label:"Ã“rbita", title:`En mi Ã³rbita`, text:`Hay gente que pasaâ€¦\nY gente que se queda en la mente como constelaciÃ³n.\n\nTÃº. ðŸª`, foot:`âœ¨`, tag:"ðŸ’Œ Carta 09" },
    ];
    notes = notes.concat(extra);
    spawnBubbles(extra);
    toast("Nuevos mensajes âœ¨");
  });

  // Reordenar
  btnShuffle.addEventListener("click", ()=>{
    layoutAll();
    toast("Reordenado âœ¨");
  });

  // AnimaciÃ³n "espacial"
  let last = performance.now();
  function tick(t){
    const dt = Math.min(32, t - last);
    last = t;

    const rect = field.getBoundingClientRect();
    const W = rect.width, H = rect.height;

    for(const b of bubbles){
      b.wobble += dt * 0.0015;
      b.x += b.vx * dt * 0.06 * (1.3 - b.z);
      b.y += b.vy * dt * 0.06 * (1.3 - b.z);

      // drift suave
      b.x += Math.sin(b.wobble) * 0.05;
      b.y += Math.cos(b.wobble*0.9) * 0.05;

      // lÃ­mites
      const bw = 160, bh = 44;
      if(b.x < 8){ b.x = 8; b.vx *= -1; }
      if(b.y < 56){ b.y = 56; b.vy *= -1; }
      if(b.x > W - bw - 8){ b.x = W - bw - 8; b.vx *= -1; }
      if(b.y > H - bh - 8){ b.y = H - bh - 8; b.vy *= -1; }

      b.el.style.transform = `translate3d(${b.x}px, ${b.y}px, 0) scale(${b.z})`;
    }

    requestAnimationFrame(tick);
  }
  requestAnimationFrame(tick);

  // Parallax â€œ3Dâ€ con movimiento del dedo (iOS friendly)
  const scene = document.getElementById("scene");
  const layer1 = document.getElementById("layer1");
  const layer2 = document.getElementById("layer2");

  let px = 0, py = 0, tx = 0, ty = 0;

  function setTargetFromPoint(x,y){
    const nx = (x / innerWidth) * 2 - 1;
    const ny = (y / innerHeight) * 2 - 1;
    tx = nx; ty = ny;
  }
  addEventListener("mousemove", (e)=> setTargetFromPoint(e.clientX, e.clientY));
  addEventListener("touchmove", (e)=>{
    if(!e.touches?.length) return;
    const t = e.touches[0];
    setTargetFromPoint(t.clientX, t.clientY);
  }, {passive:true});

  function parallax(){
    // suavizado
    px += (tx - px) * 0.06;
    py += (ty - py) * 0.06;

    const r1 = `translate3d(${px*14}px, ${py*10}px, -120px)`;
    const r2 = `translate3d(${px*8}px, ${py*6}px, -40px)`;
    layer1.style.transform = r1;
    layer2.style.transform = r2;

    requestAnimationFrame(parallax);
  }
  requestAnimationFrame(parallax);

  // Estrellas/Polvo (canvas)
  const stars = document.getElementById("stars");
  const dust  = document.getElementById("dust");
  const sctx = stars.getContext("2d");
  const dctx = dust.getContext("2d");

  function resize(){
    const dpr = Math.min(2, devicePixelRatio || 1);
    for(const c of [stars, dust]){
      c.width  = Math.floor(innerWidth * dpr);
      c.height = Math.floor(innerHeight * dpr);
      c.style.width = "100%";
      c.style.height = "100%";
    }
    sctx.setTransform(dpr,0,0,dpr,0,0);
    dctx.setTransform(dpr,0,0,dpr,0,0);

    buildStars();
    buildDust();
  }
  addEventListener("resize", resize);

  let starPts = [];
  function buildStars(){
    starPts = [];
    const count = Math.floor((innerWidth * innerHeight) / 9000);
    for(let i=0;i<count;i++){
      starPts.push({
        x: Math.random()*innerWidth,
        y: Math.random()*innerHeight,
        r: Math.random()*1.4 + 0.2,
        a: Math.random()*0.7 + 0.2,
        tw: Math.random()*Math.PI*2
      });
    }
  }

  let dustPts = [];
  function buildDust(){
    dustPts = [];
    const count = Math.floor((innerWidth * innerHeight) / 7000);
    for(let i=0;i<count;i++){
      dustPts.push({
        x: Math.random()*innerWidth,
        y: Math.random()*innerHeight,
        r: Math.random()*2.4 + 0.4,
        a: Math.random()*0.10 + 0.03,
        z: Math.random()*1.2 + 0.4
      });
    }
  }

  function renderSky(t){
    // Stars
    sctx.clearRect(0,0,innerWidth,innerHeight);
    for(const p of starPts){
      const tw = 0.35 + 0.65*(0.5 + 0.5*Math.sin(t*0.001 + p.tw));
      sctx.globalAlpha = p.a * tw;
      sctx.fillStyle = "#ffffff";
      sctx.beginPath();
      sctx.arc(p.x + px*10*(1-p.r), p.y + py*8*(1-p.r), p.r, 0, Math.PI*2);
      sctx.fill();
    }

    // Dust
    dctx.clearRect(0,0,innerWidth,innerHeight);
    for(const p of dustPts){
      dctx.globalAlpha = p.a;
      // color suave con variaciÃ³n
      const hue = 280 + (p.x/innerWidth)*40;
      dctx.fillStyle = `hsla(${hue} 90% 75% / ${p.a})`;
      dctx.beginPath();
      dctx.arc(p.x + px*18*(1/p.z), p.y + py*14*(1/p.z), p.r, 0, Math.PI*2);
      dctx.fill();
    }

    requestAnimationFrame(renderSky);
  }

  // Init
  resize();
  spawnBubbles(notes);
  updateCounter();
  requestAnimationFrame(renderSky);
</script>
</body>
</html>
